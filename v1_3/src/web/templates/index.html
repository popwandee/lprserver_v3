{% extends "base.html" %}

{% set active_page = "main" %}
{% set use_socketio = true %}

{% block title %}Main Dashboard{% endblock %}

{% block additional_css %}
<link href="{{ url_for('static', filename='css/dashboard.css') }}" rel="stylesheet">
{% endblock %}

{% block page_header %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container text-center">
        <h1 class="display-4 mb-4">
            <i class="fas fa-camera"></i> AI Camera System
        </h1>
        <p class="lead mb-4">
            Advanced camera management system with real-time video streaming, 
            AI detection capabilities, and comprehensive monitoring.
        </p>
        <div class="mt-4">
            <a href="/camera" class="btn btn-light btn-lg me-3">
                <i class="fas fa-video"></i> Camera Dashboard
            </a>
            <a href="/health" class="btn btn-outline-light btn-lg">
                <i class="fas fa-heartbeat"></i> System Health
            </a>
        </div>
    </div>
</section>
{% endblock %}

{% block container_class %}my-5{% endblock %}

{% block content %}
<!-- System Status -->
<div class="row mb-5">
    <div class="col-12">
        <h2 class="mb-4">
            <i class="fas fa-info-circle"></i> System Status
        </h2>
    </div>

    <div class="col-md-3">
        <div class="status-card text-center">
            <i class="fas fa-camera feature-icon text-primary"></i>
            <h5>Camera Status</h5>
            <span id="main-camera-status" class="status-indicator status-offline"></span>
            <span id="main-camera-status-text">Offline</span>
        </div>
    </div>

    <div class="col-md-3">
        <div class="status-card text-center">
            <i class="fas fa-brain feature-icon text-success"></i>
            <h5>AI Detection</h5>
            <span id="main-detection-status" class="status-indicator status-offline"></span>
            <span id="main-detection-status-text">Inactive</span>
        </div>
    </div>

    <div class="col-md-3">
        <div class="status-card text-center">
            <i class="fas fa-server feature-icon text-info"></i>
            <h5>System Health</h5>
            <span id="main-system-status" class="status-indicator status-online"></span>
            <span id="main-system-status-text">Healthy</span>
        </div>
    </div>
    
    <div class="col-md-3">
        <div class="status-card text-center">
            <i class="fas fa-database feature-icon text-warning"></i>
            <h5>Database</h5>
            <span id="main-database-status" class="status-indicator status-online"></span>
            <span id="main-database-status-text">Connected</span>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row mb-5">
    <div class="col-12">
        <h2 class="mb-4">
            <i class="fas fa-bolt"></i> Quick Actions
        </h2>
    </div>
    
    <div class="col-12 text-center">
        <a href="/camera" class="quick-action-btn btn btn-primary" onclick="handleQuickAction('camera-control')">
            <i class="fas fa-video"></i><br>
            <strong>Camera Control</strong><br>
            <small>Start/Stop streaming, adjust settings</small>
        </a>
        
        <a href="#" class="quick-action-btn btn btn-success" onclick="handleQuickAction('capture-image')">
            <i class="fas fa-camera"></i><br>
            <strong>Capture Image</strong><br>
            <small>Take a photo</small>
        </a>
        
        <a href="/health" class="quick-action-btn btn btn-info" onclick="handleQuickAction('system-health')">
            <i class="fas fa-heartbeat"></i><br>
            <strong>System Health</strong><br>
            <small>Monitor system status</small>
        </a>
        
        <a href="/detection" class="quick-action-btn btn btn-warning" onclick="handleQuickAction('ai-detection')">
            <i class="fas fa-brain"></i><br>
            <strong>AI Detection</strong><br>
            <small>Configure AI models</small>
        </a>
    </div>
</div>

<!-- System Information -->
<div class="row mb-5">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-info-circle"></i> System Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Camera Model:</strong> <span id="main-camera-model">Loading...</span></p>
                        <p><strong>Camera Resolution:</strong> <span id="main-camera-resolution">Loading...</span></p>
                        <p><strong>Camera FPS:</strong> <span id="main-camera-fps">Loading...</span></p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Camera Status:</strong> <span id="main-camera-detail-status">Loading...</span></p>
                        <p><strong>System Uptime:</strong> <span id="main-system-uptime">Loading...</span></p>
                        <p><strong>Database Status:</strong> <span id="main-database-detail-status">Connected</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-terminal"></i> System Log</h5>
            </div>
            <div class="card-body p-0">
                <div class="log-container" id="main-system-log" style="height: 200px;">
                    <div class="text-muted p-3">System log will appear here...</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Features -->
<div class="row">
    <div class="col-12">
        <h2 class="mb-4">
            <i class="fas fa-star"></i> System Features
        </h2>
    </div>
    
    <div class="col-md-4 mb-4">
        <div class="card feature-card h-100">
            <div class="card-body text-center">
                <i class="fas fa-video feature-icon text-primary"></i>
                <h5 class="card-title">Real-time Video Streaming</h5>
                <p class="card-text">
                    High-quality video streaming with configurable resolution, 
                    frame rate, and camera settings. Support for both main and 
                    low-resolution streams.
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4 mb-4">
        <div class="card feature-card h-100">
            <div class="card-body text-center">
                <i class="fas fa-brain feature-icon text-success"></i>
                <h5 class="card-title">AI Detection Pipeline</h5>
                <p class="card-text">
                    Advanced AI detection capabilities using Hailo AI models. 
                    Support for vehicle detection, license plate recognition, 
                    and custom object detection.
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4 mb-4">
        <div class="card feature-card h-100">
            <div class="card-body text-center">
                <i class="fas fa-cogs feature-icon text-info"></i>
                <h5 class="card-title">Advanced Configuration</h5>
                <p class="card-text">
                    Comprehensive camera configuration including exposure, 
                    white balance, focus controls, and image processing parameters.
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4 mb-4">
        <div class="card feature-card h-100">
            <div class="card-body text-center">
                <i class="fas fa-chart-line feature-icon text-warning"></i>
                <h5 class="card-title">System Monitoring</h5>
                <p class="card-text">
                    Real-time system health monitoring with performance metrics, 
                    error tracking, and automated health checks.
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4 mb-4">
        <div class="card feature-card h-100">
            <div class="card-body text-center">
                <i class="fas fa-database feature-icon text-danger"></i>
                <h5 class="card-title">Data Management</h5>
                <p class="card-text">
                    Efficient data storage and management for captured images, 
                    detection results, and system logs.
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4 mb-4">
        <div class="card feature-card h-100">
            <div class="card-body text-center">
                <i class="fas fa-network-wired feature-icon text-secondary"></i>
                <h5 class="card-title">WebSocket Communication</h5>
                <p class="card-text">
                    Real-time bidirectional communication for instant updates, 
                    remote control, and live status monitoring.
                </p>
            </div>
        </div>
    </div>
</div>

<!-- System Information -->
<div class="row mt-5">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-info-circle"></i> System Information
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6>Camera Information</h6>
                        <ul class="list-unstyled">
                            <li><strong>Model:</strong> <span id="feature-camera-model">Loading...</span></li>
                            <li><strong>Resolution:</strong> <span id="feature-camera-resolution">Loading...</span></li>
                            <li><strong>Frame Rate:</strong> <span id="feature-camera-fps">Loading...</span></li>
                            <li><strong>Status:</strong> <span id="main-camera-feature-status">Loading...</span></li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>System Information</h6>
                        <ul class="list-unstyled">
                            <li><strong>Version:</strong> AI Camera v1.3</li>
                            <li><strong>Architecture:</strong> Dependency Injection + Flask Blueprints</li>
                            <li><strong>Camera Library:</strong> Picamera2</li>
                            <li><strong>AI Framework:</strong> Hailo AI</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block additional_js %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}